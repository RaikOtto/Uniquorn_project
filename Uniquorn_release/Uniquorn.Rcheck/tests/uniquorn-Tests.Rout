
R version 3.4.0 (2017-04-21) -- "You Stupid Darkness"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("Uniquorn")
> library("testthat")
> 
> HT29_vcf_file = system.file("extdata/HT29.vcf.gz", package="Uniquorn")
> 
> ident_result = identify_vcf_file( HT29_vcf_file, ref_gen = "GRCH37", verbose = TRUE )
[1] "Assuming reference genome GRCH37"
[1] "Reading VCF file: /Users/raikotto/Dropbox/PhD/Uniquorn_project/Uniquorn_release/Uniquorn.Rcheck/Uniquorn/extdata/HT29.vcf.gz"
[1] "Finished reading the VCF file, loading database"
[1] "Found 60 many CLs for reference genome GRCH37"
[1] "Finished reading database, identifying CL"
[1] "Adjusted mutational inclusion weight, \n                                   only using mutations that are have a weight higher than 0.5"
[1] "Found 57126 many mutations with mutational weight of at least 0.5"
Correcting the background due to traces of random, scale-freeness amounts of matches, 
            requiring at least 50 variants to match.
[1] "Candidate(s): HT29"
[1] "Storing information in table: /Users/raikotto/Dropbox/PhD/Uniquorn_project/Uniquorn_release/Uniquorn.Rcheck/Uniquorn/extdata/HT29.vcf.gz_uniquorn_ident.tab"
Warning message:
In identify_vcf_file(HT29_vcf_file, ref_gen = "GRCH37", verbose = TRUE) :
  CCLE & CoSMIC CLP cancer cell line fingerprint NOT 
              found, defaulting to 60 CellMiner cancer cell lines! 
              It is strongly advised to add ~1900 CCLE & CoSMIC CLs, see readme.
> 
> expect_that( ident_result, is_a("data.frame") )
> 
> expect_that( dim(ident_result)[1], equals( 60  ) )
> expect_that( dim(ident_result)[2], equals( 10  ) )
> 
> expect_that( as.logical( ident_result$Conf_score_sig[1] ),  equals( rep(TRUE,1)  ) )
> expect_that( as.logical( ident_result$Conf_score_sig[2:60] ), equals( rep(FALSE,60-1)  ) )
> 
> proc.time()
   user  system elapsed 
 12.337   0.345  12.695 
